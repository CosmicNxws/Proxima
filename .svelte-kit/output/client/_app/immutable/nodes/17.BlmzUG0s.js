import"../chunks/CWj6FrbW.js";import"../chunks/69_IOA4Y.js";import{p as T,ai as s,aj as o,al as y,ak as A,a as F,ah as k,a5 as P,A as U,f as l,am as M}from"../chunks/CB1frHmv.js";import{s as g}from"../chunks/DNTWRfH6.js";import{i as I}from"../chunks/C2VGr2dc.js";import{t as _,a as p,c as z}from"../chunks/BcAi3mOv.js";import{e as B}from"../chunks/CJQgs8yU.js";import{i as O}from"../chunks/k_zFxMFI.js";import{p as j}from"../chunks/DyYHv-5_.js";import{o as H}from"../chunks/DdAyXo9e.js";import{s as J}from"../chunks/CCdYDHFT.js";var K=_('<div class="profile svelte-ptoh3f"><h2 class="svelte-ptoh3f"> </h2> <p class="svelte-ptoh3f"> </p> <div class="stats svelte-ptoh3f"><span class="svelte-ptoh3f"> </span> <span class="svelte-ptoh3f"> </span></div></div>');function N(i,n){T(n,!1);let a=j(n,"user",8);O();var e=K(),t=s(e),w=s(t,!0);o(t);var f=y(t,2),D=s(f);o(f);var x=y(f,2),d=s(x),r=s(d);o(d);var v=y(d,2),E=s(v);o(v),o(x),o(e),A(()=>{g(w,a().name),g(D,`@${a().username??""}`),g(r,`Posts: ${a().posts??""}`),g(E,`Comments: ${a().comments??""}`)}),p(i,e),F()}const Q=async i=>{if(!/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(i))throw new Error("Invalid user ID format");try{const{data:a,error:e}=await J.from("users").select("id, email, username, avatar_url, created_at").eq("id",i).single();if(e)throw console.error("Supabase Error Details:",{code:e.code,message:e.message,details:e.details}),e.code==="PGRST116"?new Error("User not found"):new Error("Database error occurred");return a}catch(a){throw console.error("Full fetchUser Error:",{error:a,userId:i,timestamp:new Date().toISOString()}),a}};var V=_('<div class="loading svelte-1li6gia">Loading profile...</div>'),W=_(`<p>This user doesn't exist</p> <a href="/">Return home</a>`,1),X=_("<p> </p> <button>Try Again</button>",1),Y=_('<div class="error svelte-1li6gia"><!></div>');function fe(i,n){T(n,!1);let a=j(n,"data",8),e=U(null),t=U(null),w=U(!0);H(async()=>{try{console.log("Fetching user with ID:",a().userId),P(e,await Q(a().userId)),console.log("Received user data:",l(e))}catch(r){P(t,r.message),console.error("Profile load failed:",{error:r,userId:a().userId,time:new Date().toISOString()})}finally{P(w,!1)}}),O();var f=z(),D=k(f);{var x=r=>{var v=V();p(r,v)},d=(r,v)=>{{var E=c=>{var u=Y(),S=s(u);{var h=m=>{var b=W();M(2),p(m,b)},C=m=>{var b=X(),R=k(b),G=s(R);o(R);var L=y(R,2);A(()=>g(G,`Error: ${l(t)??""}`)),B("click",L,()=>location.reload()),p(m,b)};I(S,m=>{l(t).includes("not found")?m(h):m(C,!1)})}o(u),p(c,u)},q=(c,u)=>{{var S=h=>{N(h,{get user(){return l(e)}})};I(c,h=>{l(e)&&h(S)},u)}};I(r,c=>{l(t)?c(E):c(q,!1)},v)}};I(D,r=>{l(w)?r(x):r(d,!1)})}p(i,f),F()}export{fe as component};
