import"./CWj6FrbW.js";import"./69_IOA4Y.js";import{p as j,ai as l,aj as n,ak as x,i as C,a as B,al as b,f as k,A as F,a5 as I}from"./CB1frHmv.js";import{s as f}from"./DNTWRfH6.js";import{t as y,a as A}from"./BcAi3mOv.js";import{i as q}from"./k_zFxMFI.js";import{p as u}from"./DyYHv-5_.js";import{e as _}from"./CJQgs8yU.js";import{s as h}from"./DfDlJKR5.js";import{w as D}from"./CM3tjGAh.js";import{s as p}from"./CCdYDHFT.js";const G=D([]),H=async o=>{const{data:e,error:t}=await p.rpc("toggle_bookmark",{article_id:o});if(t)throw t;G.update(r=>r.includes(o)?r.filter(s=>s!==o):[...r,o])};var J=y("<button> </button>");function K(o,e){j(e,!1);let t=u(e,"articleId",8),r=u(e,"isBookmarked",12,!1);const s=async()=>{await H(t()),r(!r())};q();var a=J();let d;var c=l(a,!0);n(a),x(v=>{d=h(a,1,"svelte-1kq978e",null,d,v),f(c,r()?"★":"☆")},[()=>({active:r()})],C),_("click",a,s),A(o,a),B()}const at=D([]),L=async o=>{const{data:e,error:t}=await p.from("articles").update({upvotes:p.rpc("increment")}).eq("id",o);if(t)throw t;return e},M=async o=>{const{data:e,error:t}=await p.from("articles").update({downvotes:p.rpc("increment")}).eq("id",o);if(t)throw t;return e};var N=y('<div class="vote-buttons svelte-zfll0v"><button> </button> <button> </button></div>');function O(o,e){j(e,!1);let t=u(e,"articleId",8),r=u(e,"upvotes",8,0),s=u(e,"downvotes",8,0),a=F(null);const d=async()=>{k(a)!=="up"&&(await L(t()),I(a,"up"))},c=async()=>{k(a)!=="down"&&(await M(t()),I(a,"down"))};q();var v=N(),i=l(v);let m;var g=l(i);n(i);var w=b(i,2);let z;var U=l(w);n(w),n(v),x((V,E)=>{m=h(i,1,"svelte-zfll0v",null,m,V),f(g,`👍 ${r()??""}`),z=h(w,1,"svelte-zfll0v",null,z,E),f(U,`👎 ${s()??""}`)},[()=>({active:k(a)==="up"}),()=>({active:k(a)==="down"})],C),_("click",i,d),_("click",w,c),A(o,v),B()}var P=y('<article class="article-card svelte-iojgjn"><h2 class="svelte-iojgjn"> </h2> <p class="svelte-iojgjn"> </p> <div class="actions svelte-iojgjn"><!> <!></div></article>');function ot(o,e){j(e,!1);let t=u(e,"article",8),r=u(e,"isBookmarked",8,!1);q();var s=P(),a=l(s),d=l(a,!0);n(a);var c=b(a,2),v=l(c,!0);n(c);var i=b(c,2),m=l(i);O(m,{get articleId(){return t().id},get upvotes(){return t().upvotes},get downvotes(){return t().downvotes}});var g=b(m,2);K(g,{get articleId(){return t().id},get isBookmarked(){return r()}}),n(i),n(s),x(()=>{f(d,t().title),f(v,t().excerpt)}),A(o,s),B()}export{ot as A,at as a,G as b};
